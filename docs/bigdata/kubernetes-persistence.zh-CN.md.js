webpackJsonp([50],{1323:function(n,s){n.exports={content:["article",["h2","Kubernetes \u6301\u4e45\u5316"],["p","Kubernetes \u6700\u5c0f\u5355\u5143\u662fPod\uff0c Pod\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u8fd0\u884clinux\u7684Container\uff0c\u5f53\u6211\u4eec\u90e8\u7f72\u5e94\u7528\u7684\u65f6\u5019\n\u5e94\u7528\u5c31\u8fd0\u884c\u5728\u8fd9\u4e9bContainer\u4e2d\uff0c\u901a\u8fc7Deployment\u58f0\u660e\u6211\u4eec\u53ef\u4ee5\u5bf9\u5e94\u7528\u8fdb\u884c\u6269\u5bb9\u3002 \u5f53\u6269\u5bb9\u7f29\u5bb9\u4e4b\u540e\u8fd0\u884c\n\u5728Container\u4e2d\u7684\u5e94\u7528\u5982\u679c\u6ca1\u6709\u505a\u6570\u636e\u6301\u4e45\u5316\uff0c\u6570\u636e\u5c31\u4f1a\u4e22\u5931"],["h2","Kubernetes Mysql \u6301\u4e45\u5316"],["p","\u6b64\u6b21\u5b9e\u9a8c\u4f7f\u7528\u7684\u662fminikube\u53ea\u6709\u5355\u4e2a\u8282\u70b9\uff0c\u6b64\u65f6\u6d89\u53ca\u5230\u4e09\u4e2a\u89d2\u8272\uff0c\u5206\u522b\u662f\u5bbf\u4e3b\u673a\uff0cminikube\uff0ccontainer"],["p","\u9996\u5148\u628a\u5bbf\u4e3b\u673a\u7684/Users/jet/kubernetes/mysql\u6620\u5c04\u5230minikube\u7684/data/kubernetes/mysql\u76ee\u5f55\u4e0b\n\u5c06/data/kubernetes/mysql\u6620\u5c04\u5230/\u5bb9\u5668\u7684/var/lib/mysql"],["p","\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u5230\u5bbf\u4e3b\u673a\u6620\u5c04\u5230minikube\u65f6\u6587\u4ef6\u7684\u7528\u6237\u7ec4\u4e3adocker"],["pre",{lang:null,highlighted:'minikube ssh\n\nls <span class="token operator">-</span>al <span class="token operator">/</span>data<span class="token operator">/</span>kubernetes<span class="token operator">/</span>\ntotal <span class="token number">3</span>\ndrwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x <span class="token number">1</span> docker docker  <span class="token number">64</span> Sep  <span class="token number">1</span> <span class="token number">05</span><span class="token punctuation">:</span><span class="token number">29</span> kafka\ndrwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x <span class="token number">1</span> docker docker <span class="token number">864</span> Sep  <span class="token number">3</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">19</span> mysql\ndrwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x <span class="token number">1</span> docker docker  <span class="token number">64</span> Aug <span class="token number">25</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">26</span> nginx\ndrwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x <span class="token number">1</span> docker docker <span class="token number">128</span> Sep  <span class="token number">1</span> <span class="token number">16</span><span class="token punctuation">:</span><span class="token number">32</span> redis\ndrwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x <span class="token number">1</span> docker docker  <span class="token number">64</span> Sep  <span class="token number">1</span> <span class="token number">05</span><span class="token punctuation">:</span><span class="token number">29</span> zookeeper'},["code","minikube ssh\n\nls -al /data/kubernetes/\ntotal 3\ndrwxr-xr-x 1 docker docker  64 Sep  1 05:29 kafka\ndrwxr-xr-x 1 docker docker 864 Sep  3 13:19 mysql\ndrwxr-xr-x 1 docker docker  64 Aug 25 14:26 nginx\ndrwxr-xr-x 1 docker docker 128 Sep  1 16:32 redis\ndrwxr-xr-x 1 docker docker  64 Sep  1 05:29 zookeeper"]],["p","\u5bb9\u5668\u4e5f\u5fc5\u987b\u4f7f\u7528docker\u7528\u6237\u8fd0\u884c\u5426\u5219\u65e0\u6cd5\u521b\u5efa\u76f8\u5173\u7684\u76ee\u5f55\uff0c \u67e5\u770b\u5f97\u77e5docker\u7684\u7528\u6237id\u4e3a 1000"],["pre",{lang:null,highlighted:'cat <span class="token operator">/</span>etc<span class="token operator">/</span>passwd\nroot<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">:</span>root<span class="token punctuation">:</span><span class="token operator">/</span>root<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span>sh\ndaemon<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span>daemon<span class="token punctuation">:</span><span class="token operator">/</span>usr<span class="token operator">/</span>sbin<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nbin<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span>bin<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nsys<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span>sys<span class="token punctuation">:</span><span class="token operator">/</span>dev<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nsync<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">:</span>sync<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span>sync\nmail<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span>mail<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token operator">/</span>spool<span class="token operator">/</span>mail<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nwww<span class="token operator">-</span>data<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">:</span>www<span class="token operator">-</span>data<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\noperator<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span><span class="token number">37</span><span class="token punctuation">:</span>Operator<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nnobody<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">65534</span><span class="token punctuation">:</span><span class="token number">65534</span><span class="token punctuation">:</span>nobody<span class="token punctuation">:</span><span class="token operator">/</span>home<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\ndocker<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">:</span><span class="token number">1000</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token punctuation">:</span><span class="token operator">/</span>home<span class="token operator">/</span>docker<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span>bash\ndbus<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1001</span><span class="token punctuation">:</span><span class="token number">1001</span><span class="token punctuation">:</span>DBus messagebus user<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token operator">/</span>run<span class="token operator">/</span>dbus<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nsshd<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1002</span><span class="token punctuation">:</span><span class="token number">1002</span><span class="token punctuation">:</span>SSH drop priv user<span class="token punctuation">:</span><span class="token operator">/</span><span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nsystemd<span class="token operator">-</span>bus<span class="token operator">-</span>proxy<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1003</span><span class="token punctuation">:</span><span class="token number">1007</span><span class="token punctuation">:</span>Proxy D<span class="token operator">-</span>Bus messages <span class="token keyword">to</span><span class="token operator">/</span>from a bus<span class="token punctuation">:</span><span class="token operator">/</span><span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nsystemd<span class="token operator">-</span>journal<span class="token operator">-</span>gateway<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1004</span><span class="token punctuation">:</span><span class="token number">1008</span><span class="token punctuation">:</span>Journal Gateway<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>journal<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nsystemd<span class="token operator">-</span>journal<span class="token operator">-</span>remote<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1005</span><span class="token punctuation">:</span><span class="token number">1009</span><span class="token punctuation">:</span>Journal Remote<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>journal<span class="token operator">/</span>remote<span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nsystemd<span class="token operator">-</span>journal<span class="token operator">-</span>upload<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1006</span><span class="token punctuation">:</span><span class="token number">1010</span><span class="token punctuation">:</span>Journal Upload<span class="token punctuation">:</span><span class="token operator">/</span><span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nsystemd<span class="token operator">-</span>network<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1007</span><span class="token punctuation">:</span><span class="token number">1011</span><span class="token punctuation">:</span>Network Manager<span class="token punctuation">:</span><span class="token operator">/</span><span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>\nsystemd<span class="token operator">-</span>resolve<span class="token punctuation">:</span>x<span class="token punctuation">:</span><span class="token number">1008</span><span class="token punctuation">:</span><span class="token number">1012</span><span class="token punctuation">:</span>Network Name Resolution Manager<span class="token punctuation">:</span><span class="token operator">/</span><span class="token punctuation">:</span><span class="token operator">/</span>bin<span class="token operator">/</span><span class="token boolean">false</span>'},["code","cat /etc/passwd\nroot:x:0:0:root:/root:/bin/sh\ndaemon:x:1:1:daemon:/usr/sbin:/bin/false\nbin:x:2:2:bin:/bin:/bin/false\nsys:x:3:3:sys:/dev:/bin/false\nsync:x:4:100:sync:/bin:/bin/sync\nmail:x:8:8:mail:/var/spool/mail:/bin/false\nwww-data:x:33:33:www-data:/var/www:/bin/false\noperator:x:37:37:Operator:/var:/bin/false\nnobody:x:65534:65534:nobody:/home:/bin/false\ndocker:x:1000:1000:-:/home/docker:/bin/bash\ndbus:x:1001:1001:DBus messagebus user:/var/run/dbus:/bin/false\nsshd:x:1002:1002:SSH drop priv user:/:/bin/false\nsystemd-bus-proxy:x:1003:1007:Proxy D-Bus messages to/from a bus:/:/bin/false\nsystemd-journal-gateway:x:1004:1008:Journal Gateway:/var/log/journal:/bin/false\nsystemd-journal-remote:x:1005:1009:Journal Remote:/var/log/journal/remote:/bin/false\nsystemd-journal-upload:x:1006:1010:Journal Upload:/:/bin/false\nsystemd-network:x:1007:1011:Network Manager:/:/bin/false\nsystemd-resolve:x:1008:1012:Network Name Resolution Manager:/:/bin/false"]],["p","\u521b\u5efamysql persistence volume\uff0c"],["p","kubectl apply -f mysql-pv.yaml"],["pre",{lang:null,highlighted:'apiVersion<span class="token punctuation">:</span> v1\nkind<span class="token punctuation">:</span> PersistentVolume\nmetadata<span class="token punctuation">:</span>\n  name<span class="token punctuation">:</span> mysql<span class="token operator">-</span>pv<span class="token operator">-</span>volume\n  namespace<span class="token punctuation">:</span> prod\n  labels<span class="token punctuation">:</span>\n    type<span class="token punctuation">:</span> <span class="token keyword">local</span>\nspec<span class="token punctuation">:</span>\n  storageClassName<span class="token punctuation">:</span> standard\n  capacity<span class="token punctuation">:</span>\n    storage<span class="token punctuation">:</span> 10Gi\n  accessModes<span class="token punctuation">:</span>\n    <span class="token operator">-</span> ReadWriteOnce\n  hostPath<span class="token punctuation">:</span>\n    path<span class="token punctuation">:</span> <span class="token operator">/</span>data<span class="token operator">/</span>kubernetes<span class="token operator">/</span>mysql\n    \n<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>\napiVersion<span class="token punctuation">:</span> v1\nkind<span class="token punctuation">:</span> PersistentVolumeClaim\nmetadata<span class="token punctuation">:</span>\n  name<span class="token punctuation">:</span> mysql<span class="token operator">-</span>pv<span class="token operator">-</span>claim\n  namespace<span class="token punctuation">:</span> prod\nspec<span class="token punctuation">:</span>\n  storageClassName<span class="token punctuation">:</span> standard\n  accessModes<span class="token punctuation">:</span>\n    <span class="token operator">-</span> ReadWriteOnce\n  resources<span class="token punctuation">:</span>\n    requests<span class="token punctuation">:</span>\n      storage<span class="token punctuation">:</span> 10Gi'},["code","apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: mysql-pv-volume\n  namespace: prod\n  labels:\n    type: local\nspec:\n  storageClassName: standard\n  capacity:\n    storage: 10Gi\n  accessModes:\n    - ReadWriteOnce\n  hostPath:\n    path: /data/kubernetes/mysql\n    \n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: mysql-pv-claim\n  namespace: prod\nspec:\n  storageClassName: standard\n  accessModes:\n    - ReadWriteOnce\n  resources:\n    requests:\n      storage: 10Gi"]],["p","\u521b\u5efamysql deployment "],["p","kubectl apply -f mysql-deployment.yaml"],["pre",{lang:null,highlighted:'apiVersion<span class="token punctuation">:</span> apps<span class="token operator">/</span>v1 \nkind<span class="token punctuation">:</span> Deployment\nmetadata<span class="token punctuation">:</span>\n  name<span class="token punctuation">:</span> mysql<span class="token operator">-</span>deployment\n  namespace<span class="token punctuation">:</span> prod\n  labels<span class="token punctuation">:</span>\n    app<span class="token punctuation">:</span> mysql\nspec<span class="token punctuation">:</span>\n  selector<span class="token punctuation">:</span>\n    matchLabels<span class="token punctuation">:</span>\n      app<span class="token punctuation">:</span> mysql\n  template<span class="token punctuation">:</span>\n    metadata<span class="token punctuation">:</span>\n      labels<span class="token punctuation">:</span>\n        app<span class="token punctuation">:</span> mysql\n    spec<span class="token punctuation">:</span>\n      containers<span class="token punctuation">:</span>\n      <span class="token operator">-</span> image<span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>latest\n        name<span class="token punctuation">:</span> mysql\n        env<span class="token punctuation">:</span>\n        <span class="token operator">-</span> name<span class="token punctuation">:</span> MYSQL_ROOT_PASSWORD              #\u6307\u5b9a\u4ee5mysql root \u5bc6\u7801\n          value<span class="token punctuation">:</span> password\n        ports<span class="token punctuation">:</span>\n        <span class="token operator">-</span> containerPort<span class="token punctuation">:</span> <span class="token number">3306</span>\n          name<span class="token punctuation">:</span> mysql\n        volumeMounts<span class="token punctuation">:</span>\n        <span class="token operator">-</span> name<span class="token punctuation">:</span> mysql<span class="token operator">-</span>persistent<span class="token operator">-</span>storage\n          mountPath<span class="token punctuation">:</span> <span class="token operator">/</span>var<span class="token operator">/</span>lib<span class="token operator">/</span>mysql\n      volumes<span class="token punctuation">:</span>\n      <span class="token operator">-</span> name<span class="token punctuation">:</span> mysql<span class="token operator">-</span>persistent<span class="token operator">-</span>storage\n        # hostPath<span class="token punctuation">:</span>\n        #   path<span class="token punctuation">:</span> <span class="token operator">/</span>data<span class="token operator">/</span>kubernetes<span class="token operator">/</span>mysql\n        persistentVolumeClaim<span class="token punctuation">:</span>\n          claimName<span class="token punctuation">:</span> mysql<span class="token operator">-</span>pv<span class="token operator">-</span>claim\n      securityContext<span class="token punctuation">:</span>                            #\u6307\u5b9a\u4ee5docker\u7528\u6237\u8fd0\u884c\n        runAsUser<span class="token punctuation">:</span> <span class="token number">1000</span>\n        runAsGroup<span class="token punctuation">:</span> <span class="token number">1000</span>'},["code","apiVersion: apps/v1 \nkind: Deployment\nmetadata:\n  name: mysql-deployment\n  namespace: prod\n  labels:\n    app: mysql\nspec:\n  selector:\n    matchLabels:\n      app: mysql\n  template:\n    metadata:\n      labels:\n        app: mysql\n    spec:\n      containers:\n      - image: mysql:latest\n        name: mysql\n        env:\n        - name: MYSQL_ROOT_PASSWORD              #\u6307\u5b9a\u4ee5mysql root \u5bc6\u7801\n          value: password\n        ports:\n        - containerPort: 3306\n          name: mysql\n        volumeMounts:\n        - name: mysql-persistent-storage\n          mountPath: /var/lib/mysql\n      volumes:\n      - name: mysql-persistent-storage\n        # hostPath:\n        #   path: /data/kubernetes/mysql\n        persistentVolumeClaim:\n          claimName: mysql-pv-claim\n      securityContext:                            #\u6307\u5b9a\u4ee5docker\u7528\u6237\u8fd0\u884c\n        runAsUser: 1000\n        runAsGroup: 1000"]],["p","\u9a8c\u8bc1\uff1a"],["p",["img",{title:null,src:"./assets/kuberpetes-persistence.png",alt:"Kubernetes Persistence"}]]],meta:{order:1,title:"Kubernetes \u6301\u4e45\u5316",type:"\u5165\u95e8",filename:"docs/bigdata/kubernetes-persistence.zh-CN.md"},toc:["ul",["li",["a",{className:"bisheng-toc-h2",href:"#Kubernetes-\u6301\u4e45\u5316",title:"Kubernetes \u6301\u4e45\u5316"},"Kubernetes \u6301\u4e45\u5316"]],["li",["a",{className:"bisheng-toc-h2",href:"#Kubernetes-Mysql-\u6301\u4e45\u5316",title:"Kubernetes Mysql \u6301\u4e45\u5316"},"Kubernetes Mysql \u6301\u4e45\u5316"]]]}}});